{% extends "base.html" %}

{% block content %}
<div class="result-card">
    <h2>{{ mode }} Scan Result</h2>

    <p class="item">{{ item }}</p>

    <!-- Verdict -->
    <div class="verdict {{ verdict|lower }}">
    {% if verdict == "LEGITIMATE" %}
        <span class="verdict-icon">
            <!-- Check icon -->
            <svg viewBox="0 0 20 20" fill="none" aria-hidden="true">
                <path d="M16.7 5.3L8.5 13.5L3.3 8.3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
        </span>
    {% elif verdict == "SUSPICIOUS" %}
        <span class="verdict-icon">
            <!-- Warning icon -->
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 9v4m0 4h.01M10.3 3.6l-8 14a1 1 0 0 0 .9 1.4h16a1 1 0 0 0 .9-1.4l-8-14a1 1 0 0 0-1.8 0z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
        </span>
    {% else %}
        <span class="verdict-icon">
            <!-- Shield alert icon -->
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 3l7 3v6c0 5-3.5 9.7-7 11-3.5-1.3-7-6-7-11V6l7-3z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"/>
                <path d="M12 9v4m0 4h.01"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"/>
            </svg>
        </span>
    {% endif %}

    <span class="verdict-text">{{ verdict }}</span>

    {% if verdict == "SUSPICIOUS" %}
    <span class="help-tooltip">
        ⓘ
        <span class="tooltip-text">
            Indicates phishing-like characteristics with moderate confidence.
            Manual review is recommended.
        </span>
    </span>
    {% endif %}
</div>


    <!-- Recommended Action -->
    <p class="action">
        <strong>Recommended Action:</strong>
        {% if verdict == "LEGITIMATE" %}
            No action required.
        {% elif verdict == "SUSPICIOUS" %}
            Manual review recommended.
        {% else %}
            Block and report immediately.
        {% endif %}
    </p>

    <!-- Analysis Panel -->
    <div class="analysis-panel">
        <p class="confidence">
            Phishing Likelihood: <strong>{{ confidence }}%</strong>
        </p>

        <!-- Risk Meter -->
        <div class="risk-meter">
            <div
                class="risk-fill
                    {% if confidence < 30 %}
                        low
                    {% elif confidence < 60 %}
                        medium
                    {% else %}
                        high
                    {% endif %}"
                data-width="{{ confidence }}"
            ></div>
        </div>

        <!-- Explanation -->
        {% if reasons %}
        <div class="explanation">
            <h3>Detection Rationale</h3>
            <ul>
                {% for reason in reasons %}
                <li>{{ reason }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    <!-- Scan Metadata -->
    <div class="metadata">
        <p><strong>Scan Type:</strong> {{ mode }}</p>
        <p><strong>Scanned At:</strong> {{ scanned_at }}</p>
    </div>

    <!-- Severity Legend -->
    <div class="legend">
        <span class="low">Low Risk (&lt;30%)</span>
        <span class="medium">Medium Risk (30–60%)</span>
        <span class="high">High Risk (&gt;60%)</span>
    </div>

    <a href="/" class="back">← Back to Scanner</a>
</div>
{% endblock %}
